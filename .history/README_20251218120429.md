# PoliMemeDecode: RajneetiDrishti - A Two-Stage Vision-Language Ensemble Framework for Political Meme Classification

![System Architecture](Images/system%20architecture.png)

## ğŸ† CUET CSE Fest 2025 - National-Level Datathon

### Challenge: PoliMemeDecode â€” Humor That Speaks Politics

| ğŸ¯ Achievement | ğŸ… Ranking |
|---------------|------------|
| **Public Leaderboard** | ğŸ¥‰ 3rd Place |
| **Private Leaderboard** | ğŸ¥‡ 1st Place |
| **Overall Standing** | 4th out of 152 Teams |

**Team:** NeuronX (Team Lead)  
**Task:** Classify Bangla memes as **Political** or **Non-Political**

---

## ğŸ“‹ Overview

This repository contains our winning solution for the PoliMemeDecode challenge at CUET CSE Fest 2025 National-Level Datathon. We developed **RajneetiDrishti**, a two-stage Vision-Language ensemble framework for political meme classification targeting Bangladeshi political and social memes.

The task was particularly challenging due to **visually ambiguous and misleading content** that limited the effectiveness of traditional vision-based architectures. Our solution leverages state-of-the-art Vision-Language Models (VLMs) with 4-bit quantization and a static knowledge base to efficiently process and classify memes containing Bangla, English, and Banglish (Bengali text in Roman script) content.

---

## ï¿½ Competition Results

| Metric | Score |
|--------|-------|
| **Single Model F1-Score** | ~92% Macro F1 |
| **Ensemble F1-Score (Public)** | 93.7% Macro F1 |
| **Private Leaderboard F1-Score** | 89.6% Macro F1 (70% test data) |

---

## ğŸ”¬ Key Features

| Feature | Description |
|---------|-------------|
| **Two-Stage VLM Architecture** | Qwen2.5-VL for multimodal reasoning + Phi-3-mini for final classification |
| **Static Knowledge Base** | Curated political entity database for enhanced context |
| **4-Bit Quantization** | NF4 quantization via BitsAndBytes to run on Tesla T4 (16GB VRAM) |
| **VQA Chain-of-Thought Prompting** | Structured prompting generating 5 metadata columns |
| **Multilingual OCR** | Nanonets-OCR-s for Bangla/English/Banglish text extraction |
| **7 Metadata Features** | Text + 5 VQA metadata + Language info for comprehensive analysis |
| **Memory Management** | Aggressive garbage collection to prevent CUDA OOM errors |

---

## ğŸ“ Repository Structure

```
PoliMemeDecode_NeuronX/
â”œâ”€â”€ Images/
â”‚   â”œâ”€â”€ system architecture.png    # System architecture diagram
â”‚   â”œâ”€â”€ reasoning.jpg              # Reasoning visualization
â”‚   â””â”€â”€ results.png                # Results and metrics
â”œâ”€â”€ NeuronX Notebooks/
â”‚   â”œâ”€â”€ NeuronX_Two-stage-meme-classification-qwen-phi3.ipynb
â”‚   â”œâ”€â”€ NeuronX_qwen-vl-meme-metadata-cot.ipynb
â”‚   â””â”€â”€ NeuronX_nanonets-ocr-4bit-quantized.ipynb
â”œâ”€â”€ NeuronX.pdf                    # Presentation slides
â”œâ”€â”€ RajneetiDrishti__A_Two_Stage_Vision_Language_Ensemble_Framework_for_Political_Meme_Classification.pdf
â””â”€â”€ README.md
```

---

## ğŸ—ï¸ System Architecture & Workflow

### Pipeline Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           POLIMEMEDECODE PIPELINE                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Meme Image  â”‚â”€â”€â”€â–¶â”‚           PREPROCESSING STAGE                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  nanonets/Nanonets-OCR-s                            â”‚   â”‚
â”‚                      â”‚  â€¢ Text Extraction (OCR)                             â”‚   â”‚
â”‚                      â”‚  â€¢ Language Detection (Bangla/English/Banglish)      â”‚   â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚                                   â”‚
â”‚                                             â–¼                                   â”‚
â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                      â”‚           METADATA GENERATION                        â”‚   â”‚
â”‚                      â”‚  Qwen/Qwen2.5-VL-7B-Instruct (4-bit)                â”‚   â”‚
â”‚                      â”‚  VQA Chain-of-Thought Prompting                      â”‚   â”‚
â”‚                      â”‚  Generates 5 Metadata Columns:                       â”‚   â”‚
â”‚                      â”‚  â€¢ Humor Type â€¢ Metaphor â€¢ Meme Explanation          â”‚   â”‚
â”‚                      â”‚  â€¢ Metaphor Object â€¢ Political Intensity             â”‚   â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚                                   â”‚
â”‚                                             â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                         STAGE 1: MULTIMODAL REASONING                   â”‚    â”‚
â”‚  â”‚  Qwen/Qwen2.5-VL-7B-Instruct (4-bit quantized)                         â”‚    â”‚
â”‚  â”‚  Input: Meme Image + 7 Metadata Features                                â”‚    â”‚
â”‚  â”‚         (Extracted Text + 5 VQA Metadata + Language Info)               â”‚    â”‚
â”‚  â”‚  Output: Initial Political/Non-Political Prediction                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â”‚                                            â”‚
â”‚                                    â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                         STAGE 2: FINAL CLASSIFICATION                   â”‚    â”‚
â”‚  â”‚  microsoft/Phi-3-mini-128k-instruct                                     â”‚    â”‚
â”‚  â”‚  Input: Stage 1 Predictions + Static Knowledge Base                     â”‚    â”‚
â”‚  â”‚  Output: Final Political/Non-Political Classification                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â”‚                                            â”‚
â”‚                                    â–¼                                            â”‚
â”‚                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚                           â”‚  submission.csv â”‚                                   â”‚
â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Preprocessing: OCR & Language Detection (nanonets/Nanonets-OCR-s)

Specialized OCR for multilingual meme text extraction:

- **Bangla Detection**: Unicode range analysis (U+0980 to U+09FF)
- **English Detection**: Dictionary-based stop word density calculation  
- **Banglish Detection**: Roman characters without English vocabulary

### Metadata Generation: VQA Chain-of-Thought (Qwen2.5-VL-7B-Instruct)

Multimodal reasoning to generate 5 metadata columns:

- **Humor Type**: Mockery, Sarcastic, Ironic, Satirical, Other
- **Metaphor Detection**: Text, Image, or Both
- **Meme Explanation**: Contextual meaning and target analysis
- **Metaphor Object**: Specific subject or entity identification
- **Political Intensity**: High, Moderate, Low classification

### Stage 1: Multimodal Reasoning (Qwen2.5-VL-7B-Instruct)

Each meme image along with **7 metadata features** is passed for multimodal reasoning:
- Extracted Text + 5 VQA Metadata Columns + Language Information

### Stage 2: Final Classification (microsoft/Phi-3-mini-128k-instruct)

Stage 1 predictions combined with a **static knowledge base** for final classification:
- Named entity recognition for politicians and parties
- Keyword matching for political terms
- Contextual validation using curated political database

---

## ğŸ““ Notebooks Description

### 1. `NeuronX_Two-stage-meme-classification-qwen-phi3.ipynb`
**Main Classification Pipeline**

- Implements the complete two-stage classification framework
- Uses Chain-of-Thought (CoT) prompting with metadata
- Combines Qwen2.5-VL and Phi-3-Vision for robust classification
- Handles checkpoint saving and resume functionality

### 2. `NeuronX_qwen-vl-meme-metadata-cot.ipynb`
**Metadata Extraction with CoT Reasoning**

- Extracts structured metadata from meme images
- Implements few-shot Chain-of-Thought prompting
- Generates JSON output with strict schema adherence
- Handles political intensity classification with nuanced rules

### 3. `NeuronX_nanonets-ocr-4bit-quantized.ipynb`
**Multilingual OCR Pipeline**

- Specialized OCR for Bangla/English/Banglish text
- 4-bit quantized for memory efficiency (~2.5GB VRAM)
- Custom language classification heuristics
- Resolution capping for batch processing stability

---

## ğŸš€ Quick Start

### Prerequisites

- Python 3.8+
- CUDA-compatible GPU (Tesla T4 or better recommended)
- 16GB+ VRAM for full pipeline

### Installation

```bash
# Clone the repository
git clone https://github.com/Sayeem-Velocity/PoliMemeDecode_NeuronX.git
cd PoliMemeDecode_NeuronX

# Install dependencies
pip install transformers accelerate bitsandbytes
pip install pandas pillow tqdm qwen-vl-utils
```

### Running the Pipeline

1. **Upload to Kaggle** (Recommended for GPU access)
2. **Add competition dataset** to notebook inputs
3. **Run notebooks** in order:
   - OCR extraction â†’ Metadata generation â†’ Classification

---

## ğŸ“Š Classification Criteria

### Political Intensity Levels

| Level | Criteria |
|-------|----------|
| **HIGH** | Named politicians (Sheikh Hasina, Khaleda Zia, etc.), Political parties (AL, BNP, Jamaat), Keywords (Vote Chori, Genocide, Dictator) |
| **MODERATE** | General institutional criticism, Social satire without specific names, Cultural figures |
| **LOW** | Daily life content, Pop culture, Sports, Relationships |

---

## ğŸ› ï¸ Technical Specifications

| Component | Specification |
|-----------|---------------|
| **OCR Model** | nanonets/Nanonets-OCR-s (4-bit NF4) |
| **Metadata & Stage 1 Model** | Qwen/Qwen2.5-VL-7B-Instruct (4-bit NF4) |
| **Stage 2 Model** | microsoft/Phi-3-mini-128k-instruct |
| **Quantization** | BitsAndBytes NF4 with double quantization |
| **Compute Dtype** | bfloat16 / float16 |
| **Max Tokens** | 512 (configurable) |
| **Target GPU** | Tesla T4 16GB |

---

## ğŸ“ˆ Results & Leaderboard

![Results](Images/results.png)

### Performance Summary

| Configuration | Macro F1-Score | Notes |
|--------------|----------------|-------|
| Single Model (Qwen2.5-VL) | ~92% | Without ensembling |
| Ensemble (Public LB) | **93.7%** | 30% test data |
| Private Leaderboard | **89.6%** | 70% test data |

### Reasoning Visualization

![Reasoning](Images/reasoning.jpg)

---

## ğŸ“„ Documentation

- [NeuronX Presentation (PDF)](NeuronX.pdf)
- [Full Paper: RajneetiDrishti Framework](RajneetiDrishti__A_Two_Stage_Vision_Language_Ensemble_Framework_for_Political_Meme_Classification.pdf)

---

## ğŸ‘¥ Team NeuronX

**CUET CSE Fest 2025 - National-Level Datathon**

ğŸ† **Achievements:**
- ğŸ¥‰ 3rd Place on Public Leaderboard
- ğŸ¥‡ 1st Place on Private Leaderboard  
- ğŸ–ï¸ 4th Overall out of 152 Teams

*Hard luck on the final standing, but it was a great learning experience! Looking forward to achieving the best in upcoming challenges.*

---

## ğŸ“ License

This project is developed for academic competition purposes.

---

## ğŸ™ Acknowledgments

- CUET CSE Fest 2025 Organizers
- Hugging Face for Transformers library
- Qwen team for Vision-Language models
- Microsoft for Phi-3 Vision model
- Nanonets for OCR model

---

## ğŸ“§ Contact

For questions or collaboration, please open an issue in this repository.
