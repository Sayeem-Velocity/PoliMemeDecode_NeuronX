# PoliMemeDecode: RajneetiDrishti - A Vision-Language Framework for Political Meme Classification

![System Architecture](Images/system%20architecture.png)

## ğŸ† CUET CSE Fest 2025 - PoliMemeDecode Challenge

**Team:** NeuronX  
**Task:** Classify Bangla memes as **Political** or **Non-Political**

---

## ğŸ“‹ Overview

This repository contains our solution for the PoliMemeDecode challenge at CUET CSE Fest 2025. We developed **RajneetiDrishti**, a two-stage Vision-Language ensemble framework for political meme classification targeting Bangladeshi political and social memes.

The solution leverages state-of-the-art Vision-Language Models (VLMs) with 4-bit quantization to efficiently process and classify memes containing Bangla, English, and Banglish (Bengali text in Roman script) content.

---

## ğŸ”¬ Key Features

| Feature | Description |
|---------|-------------|
| **Two-Stage Classification** | Qwen2.5-VL for initial classification + Phi-3-Vision for keyword validation |
| **4-Bit Quantization** | NF4 quantization via BitsAndBytes to run on Tesla T4 (16GB VRAM) |
| **Chain-of-Thought Reasoning** | Structured prompting for better political context understanding |
| **Multilingual OCR** | Nanonets-OCR-s for Bangla/English/Banglish text extraction |
| **Structured JSON Output** | Enforced schema adherence for consistent classification |
| **Memory Management** | Aggressive garbage collection to prevent CUDA OOM errors |

---

## ğŸ“ Repository Structure

```
PoliMemeDecode_NeuronX/
â”œâ”€â”€ Images/
â”‚   â”œâ”€â”€ system architecture.png    # System architecture diagram
â”‚   â”œâ”€â”€ reasoning.jpg              # Reasoning visualization
â”‚   â””â”€â”€ results.png                # Results and metrics
â”œâ”€â”€ NeuronX Notebooks/
â”‚   â”œâ”€â”€ NeuronX_Two-stage-meme-classification-qwen-phi3.ipynb
â”‚   â”œâ”€â”€ NeuronX_qwen-vl-meme-metadata-cot.ipynb
â”‚   â””â”€â”€ NeuronX_nanonets-ocr-4bit-quantized.ipynb
â”œâ”€â”€ NeuronX.pdf                    # Presentation slides
â”œâ”€â”€ RajneetiDrishti__A_Two_Stage_Vision_Language_Ensemble_Framework_for_Political_Meme_Classification.pdf
â””â”€â”€ README.md
```

---

## ğŸ—ï¸ System Architecture

### Stage 1: Vision-Language Analysis (Qwen2.5-VL-7B-Instruct)

The first stage uses **Qwen2.5-VL-7B-Instruct** to analyze meme images and extract:

- **Humor Type**: Mockery, Sarcastic, Ironic, Satirical, Other
- **Metaphor Detection**: Text, Image, or Both
- **Meme Explanation**: Contextual meaning and target analysis
- **Metaphor Object**: Specific subject or entity identification
- **Political Intensity**: High, Moderate, Low classification

### Stage 2: Keyword-Based Validation (Phi-3-Vision-128k-Instruct)

The second stage uses **Phi-3-Vision-128k-Instruct** to validate initial classifications using:

- Named entity recognition for politicians and parties
- Keyword matching for political terms
- Contextual validation of political intensity

### OCR Pipeline (Nanonets-OCR-s)

Specialized OCR for multilingual meme text extraction:

- **Bangla Detection**: Unicode range analysis (U+0980 to U+09FF)
- **English Detection**: Dictionary-based stop word density calculation
- **Banglish Detection**: Roman characters without English vocabulary

---

## ğŸ““ Notebooks Description

### 1. `NeuronX_Two-stage-meme-classification-qwen-phi3.ipynb`
**Main Classification Pipeline**

- Implements the complete two-stage classification framework
- Uses Chain-of-Thought (CoT) prompting with metadata
- Combines Qwen2.5-VL and Phi-3-Vision for robust classification
- Handles checkpoint saving and resume functionality

### 2. `NeuronX_qwen-vl-meme-metadata-cot.ipynb`
**Metadata Extraction with CoT Reasoning**

- Extracts structured metadata from meme images
- Implements few-shot Chain-of-Thought prompting
- Generates JSON output with strict schema adherence
- Handles political intensity classification with nuanced rules

### 3. `NeuronX_nanonets-ocr-4bit-quantized.ipynb`
**Multilingual OCR Pipeline**

- Specialized OCR for Bangla/English/Banglish text
- 4-bit quantized for memory efficiency (~2.5GB VRAM)
- Custom language classification heuristics
- Resolution capping for batch processing stability

---

## ğŸš€ Quick Start

### Prerequisites

- Python 3.8+
- CUDA-compatible GPU (Tesla T4 or better recommended)
- 16GB+ VRAM for full pipeline

### Installation

```bash
# Clone the repository
git clone https://github.com/Sayeem-Velocity/PoliMemeDecode_NeuronX.git
cd PoliMemeDecode_NeuronX

# Install dependencies
pip install transformers accelerate bitsandbytes
pip install pandas pillow tqdm qwen-vl-utils
```

### Running the Pipeline

1. **Upload to Kaggle** (Recommended for GPU access)
2. **Add competition dataset** to notebook inputs
3. **Run notebooks** in order:
   - OCR extraction â†’ Metadata generation â†’ Classification

---

## ğŸ“Š Classification Criteria

### Political Intensity Levels

| Level | Criteria |
|-------|----------|
| **HIGH** | Named politicians (Sheikh Hasina, Khaleda Zia, etc.), Political parties (AL, BNP, Jamaat), Keywords (Vote Chori, Genocide, Dictator) |
| **MODERATE** | General institutional criticism, Social satire without specific names, Cultural figures |
| **LOW** | Daily life content, Pop culture, Sports, Relationships |

---

## ğŸ› ï¸ Technical Specifications

| Component | Specification |
|-----------|---------------|
| **Stage 1 Model** | Qwen2.5-VL-7B-Instruct (4-bit NF4) |
| **Stage 2 Model** | Phi-3-Vision-128k-Instruct |
| **OCR Model** | Nanonets-OCR-s (4-bit NF4) |
| **Compute Dtype** | bfloat16 / float16 |
| **Max Tokens** | 512 (configurable) |
| **Target GPU** | Tesla T4 16GB |

---

## ğŸ“ˆ Results

![Results](Images/results.png)

---

## ğŸ“„ Documentation

- [NeuronX Presentation (PDF)](NeuronX.pdf)
- [Full Paper: RajneetiDrishti Framework](RajneetiDrishti__A_Two_Stage_Vision_Language_Ensemble_Framework_for_Political_Meme_Classification.pdf)

---

## ğŸ‘¥ Team NeuronX

CUET CSE Fest 2025 - PoliMemeDecode Challenge Participants

---

## ğŸ“ License

This project is developed for academic competition purposes.

---

## ğŸ™ Acknowledgments

- CUET CSE Fest 2025 Organizers
- Hugging Face for Transformers library
- Qwen team for Vision-Language models
- Microsoft for Phi-3 Vision model
- Nanonets for OCR model

---

## ğŸ“§ Contact

For questions or collaboration, please open an issue in this repository.
